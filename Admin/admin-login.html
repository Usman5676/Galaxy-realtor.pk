<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Login - Galaxy Realtors</title>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

    <style>
        body {
            background: rgb(101, 97, 97);
            min-height: 100vh;
        }

        .loading-spinner {
            border: 2px solid #f3f3f3;
            border-top: 2px solid #e8a425;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            animation: spin 1s linear infinite;
            display: none;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .btn-loading {
            opacity: 0.7;
            cursor: not-allowed;
        }

        .notification {
            position: fixed;
            top: 15px;
            right: 15px;
            padding: 12px 16px;
            border-radius: 6px;
            color: white;
            z-index: 9999;
            max-width: 300px;
            transform: translateX(300px);
            transition: transform 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.error {
            background: #b91c1c;
        }
    </style>
</head>

<body class="min-h-screen flex items-center justify-center px-4 py-6">

    <div id="notificationContainer"></div>

    <div class="bg-black p-6 sm:p-8 rounded-lg shadow-xl w-full max-w-sm sm:max-w-md border border-[#e8a425]">

        <div class="text-center mb-6">
            <img src="https://res.cloudinary.com/delybxvjs/image/upload/v1762185342/Logo_galaxy_iq3sd4.png"
                alt="Galaxy Realtors Logo"
                class="mx-auto w-14 h-14 sm:w-20 sm:h-20 object-contain mb-3">

            <h1 class="text-lg sm:text-2xl font-bold text-[#e8a425]">
                Galaxy Realtors Builders
            </h1>
            <p class="text-gray-300 text-xs sm:text-base">Admin Panel Login</p>
        </div>

        <form id="loginForm" class="space-y-4">

            <div>
                <label for="email" class="block text-white text-sm mb-1">Email</label>
                <input type="email" id="email"
                       class="w-full px-3 py-2 sm:py-3 border border-gray-600 bg-gray-900 text-white rounded-md
                       focus:outline-none focus:ring-2 focus:ring-[#e8a425] placeholder-gray-400"
                       placeholder="admin@example.com" required>
            </div>

            <div>
                <label for="password" class="block text-white text-sm mb-1">Password</label>
                <input type="password" id="password"
                       class="w-full px-3 py-2 sm:py-3 border border-gray-600 bg-gray-900 text-white rounded-md
                       focus:outline-none focus:ring-2 focus:ring-[#e8a425] placeholder-gray-400"
                       placeholder="••••••••" required>
            </div>

            <button type="submit" id="loginBtn"
                class="w-full bg-[#e8a425] text-black font-semibold py-3 sm:py-3 rounded-md hover:bg-black
                hover:text-[#e8a425] border border-[#e8a425] transition duration-300 flex items-center justify-center gap-2">

                <span id="loginText">Sign In</span>
                <div id="loginSpinner" class="loading-spinner"></div>
            </button>

        </form>

        <div id="errorMessage"
             class="mt-3 p-3 bg-red-900 border border-red-700 text-red-200 rounded-md text-xs hidden"></div>
    </div>


    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyC9EigXaRjEA7A9YR9WgoRX7eBJGZRGf6U",
            authDomain: "galaxy-realtors.firebaseapp.com",
            databaseURL: "https://galaxy-realtors-default-rtdb.firebaseio.com",
            projectId: "galaxy-realtors",
            storageBucket: "galaxy-realtors.firebasestorage.app",
            messagingSenderId: "387847164981",
            appId: "1:387847164981:web:875e02de669488dc2a0d7c"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const ADMIN_EMAIL = "galaxyrealtormultan@gmail.com";

        auth.onAuthStateChanged(async (user) => {
            if (user) {
                if (user.email !== ADMIN_EMAIL) {
                    await auth.signOut();
                    alert("Access Denied - You are not an admin!");
                    return;
                }
                window.location.href = "admin-dashboard.html";
            }
        });

        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const errorMessage = document.getElementById('errorMessage');
            const loginBtn = document.getElementById('loginBtn');
            const loginText = document.getElementById('loginText');
            const loginSpinner = document.getElementById('loginSpinner');

            errorMessage.classList.add('hidden');
            loginBtn.classList.add('btn-loading');
            loginText.textContent = 'Signing In...';
            loginSpinner.style.display = 'block';
            loginBtn.disabled = true;

            try {
                const userCredential = await auth.signInWithEmailAndPassword(email, password);

                if (userCredential.user.email !== ADMIN_EMAIL) {
                    await auth.signOut();
                    loginText.textContent = 'Sign In';
                    loginSpinner.style.display = 'none';
                    loginBtn.disabled = false;
                    errorMessage.textContent = "Access Denied - Not an Admin User.";
                    errorMessage.classList.remove('hidden');
                    return;
                }

                loginText.textContent = 'Success! Redirecting...';
                setTimeout(() => {
                    window.location.href = "admin-dashboard.html";
                }, 1000);

            } catch (error) {
                let msg = "Login failed. Try again.";

                if (error.code === 'auth/wrong-password') msg = "Incorrect password.";
                if (error.code === 'auth/user-not-found') msg = "No user found.";
                if (error.code === 'auth/network-request-failed') msg = "Network error.";

                errorMessage.textContent = msg;
                errorMessage.classList.remove('hidden');

                loginBtn.classList.remove('btn-loading');
                loginText.textContent = 'Sign In';
                loginSpinner.style.display = 'none';
                loginBtn.disabled = false;
            }
        });
    </script>

</body>

</html>
